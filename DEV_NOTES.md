# Development Notes

## Firebase Emulator

- The application is configured to automatically connect to the Firebase Authentication Emulator when running on `localhost` or `127.0.0.1`.
- The connection logic is located in `js/firebase-auth.js`.
- The emulator UI is typically available at `http://localhost:4000`.
- To use the emulator, ensure it's running before starting the local development server. You can start the emulators using the Firebase CLI command:

  ```bash
  firebase emulators:start --only auth
  ```

  (Adjust the command if you use other emulators like Firestore or Functions).

- ## Database Integration

- When running locally with the emulator, the backend API (`/api/update_session.php`) will still sync user data (UID, email, display name, photo URL, last login) to the MySQL `users` table.
- The data synced will be the data generated by the **emulator** (e.g., emulator UIDs).
- This ensures your local database reflects the state of your local emulated authentication environment. 

## Local Database Setup (MAMP)

- Database connection details for the local environment are stored in `private/secure_variables.php`.
- This file is **required** for the application to connect to the database locally.
- It is correctly ignored by Git (via `.gitignore`) to prevent committing sensitive credentials.
- Key constants defined in this file:
    - `DB_HOST`: Set to `localhost` or `127.0.0.1`.
    - `DB_PORT`: Set to `3306` (the standard MySQL port used by MAMP).
    - `DB_NAME`: Set to `theshfmb_SPDB` (based on the provided SQL dump).
    - `DB_USER`: Set to `root` (MAMP default).
    - `DB_PASS`: Set to `root` (MAMP default).
- The database connection script `config/db_connect.php` has been updated to correctly load these defined constants.
- **PHP Error Log:** MAMP's PHP error log, which is useful for debugging database connection issues and other PHP errors, is typically located at `/Applications/MAMP/logs/php_error.log`.

## Backend / PHP Notes

- **Session Key:** The user identifier stored in the PHP session (`$_SESSION`) is consistently named `uid`, **not** `user_id`. Ensure all API scripts that check for a logged-in user use `$_SESSION['uid']`. 